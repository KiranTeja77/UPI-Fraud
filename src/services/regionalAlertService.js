import OpenAI from 'openai';
import config from '../config/config.js';

let gemini = null;

function initializeAI() {
    if (!gemini && config.geminiApiKey) {
        gemini = new OpenAI({
            apiKey: config.geminiApiKey,
            baseURL: 'https://generativelanguage.googleapis.com/v1beta/openai/'
        });
    }
}

// â”€â”€â”€ Supported Languages â”€â”€â”€
export const SUPPORTED_LANGUAGES = {
    en: { name: 'English', nativeName: 'English', flag: 'ðŸ‡¬ðŸ‡§' },
    hi: { name: 'Hindi', nativeName: 'à¤¹à¤¿à¤¨à¥à¤¦à¥€', flag: 'ðŸ‡®ðŸ‡³' },
    te: { name: 'Telugu', nativeName: 'à°¤à±†à°²à±à°—à±', flag: 'ðŸ‡®ðŸ‡³' },
    ta: { name: 'Tamil', nativeName: 'à®¤à®®à®¿à®´à¯', flag: 'ðŸ‡®ðŸ‡³' },
    kn: { name: 'Kannada', nativeName: 'à²•à²¨à³à²¨à²¡', flag: 'ðŸ‡®ðŸ‡³' },
    bn: { name: 'Bengali', nativeName: 'à¦¬à¦¾à¦‚à¦²à¦¾', flag: 'ðŸ‡®ðŸ‡³' },
    mr: { name: 'Marathi', nativeName: 'à¤®à¤°à¤¾à¤ à¥€', flag: 'ðŸ‡®ðŸ‡³' },
    gu: { name: 'Gujarati', nativeName: 'àª—à«àªœàª°àª¾àª¤à«€', flag: 'ðŸ‡®ðŸ‡³' },
    ml: { name: 'Malayalam', nativeName: 'à´®à´²à´¯à´¾à´³à´‚', flag: 'ðŸ‡®ðŸ‡³' }
};

// â”€â”€â”€ Static Fallback Alerts â”€â”€â”€
const STATIC_ALERTS = {
    en: {
        title: 'âš ï¸ Fraud Alert â€” Suspicious UPI Transaction Detected!',
        body: 'This transaction has been flagged as potentially fraudulent. Do NOT proceed. Never share your UPI PIN, OTP, or personal details with anyone.',
        actions: [
            'Do NOT complete this payment',
            'Call your bank immediately',
            'Report to Cyber Crime Helpline: 1930',
            'File a complaint at cybercrime.gov.in'
        ],
        emergency: 'Emergency: Call 1930 (National Cyber Crime Helpline)'
    },
    hi: {
        title: 'âš ï¸ à¤§à¥‹à¤–à¤¾à¤§à¤¡à¤¼à¥€ à¤šà¥‡à¤¤à¤¾à¤µà¤¨à¥€ â€” à¤¸à¤‚à¤¦à¤¿à¤—à¥à¤§ UPI à¤²à¥‡à¤¨à¤¦à¥‡à¤¨ à¤ªà¤¾à¤¯à¤¾ à¤—à¤¯à¤¾!',
        body: 'à¤¯à¤¹ à¤²à¥‡à¤¨à¤¦à¥‡à¤¨ à¤¸à¤‚à¤­à¤¾à¤µà¤¿à¤¤ à¤§à¥‹à¤–à¤¾à¤§à¤¡à¤¼à¥€ à¤•à¥‡ à¤°à¥‚à¤ª à¤®à¥‡à¤‚ à¤šà¤¿à¤¹à¥à¤¨à¤¿à¤¤ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤ à¤†à¤—à¥‡ à¤¨ à¤¬à¤¢à¤¼à¥‡à¤‚à¥¤ à¤…à¤ªà¤¨à¤¾ UPI PIN, OTP à¤¯à¤¾ à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤•à¤¿à¤¸à¥€ à¤•à¥‡ à¤¸à¤¾à¤¥ à¤¸à¤¾à¤à¤¾ à¤¨ à¤•à¤°à¥‡à¤‚à¥¤',
        actions: [
            'à¤¯à¤¹ à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤ªà¥‚à¤°à¤¾ à¤¨ à¤•à¤°à¥‡à¤‚',
            'à¤…à¤ªà¤¨à¥‡ à¤¬à¥ˆà¤‚à¤• à¤•à¥‹ à¤¤à¥à¤°à¤‚à¤¤ à¤•à¥‰à¤² à¤•à¤°à¥‡à¤‚',
            'à¤¸à¤¾à¤‡à¤¬à¤° à¤•à¥à¤°à¤¾à¤‡à¤® à¤¹à¥‡à¤²à¥à¤ªà¤²à¤¾à¤‡à¤¨ à¤ªà¤° à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤•à¤°à¥‡à¤‚: 1930',
            'cybercrime.gov.in à¤ªà¤° à¤¶à¤¿à¤•à¤¾à¤¯à¤¤ à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚'
        ],
        emergency: 'à¤†à¤ªà¤¾à¤¤à¤•à¤¾à¤²à¥€à¤¨: 1930 (à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤¸à¤¾à¤‡à¤¬à¤° à¤…à¤ªà¤°à¤¾à¤§ à¤¹à¥‡à¤²à¥à¤ªà¤²à¤¾à¤‡à¤¨) à¤ªà¤° à¤•à¥‰à¤² à¤•à¤°à¥‡à¤‚'
    },
    te: {
        title: 'âš ï¸ à°®à±‹à°¸à°‚ à°¹à±†à°šà±à°šà°°à°¿à°• â€” à°…à°¨à±à°®à°¾à°¨à°¾à°¸à±à°ªà°¦ UPI à°²à°¾à°µà°¾à°¦à±‡à°µà±€ à°—à±à°°à±à°¤à°¿à°‚à°šà°¬à°¡à°¿à°‚à°¦à°¿!',
        body: 'à°ˆ à°²à°¾à°µà°¾à°¦à±‡à°µà±€ à°®à±‹à°¸à°‚ à°•à°¾à°µà°šà±à°šà°¨à°¿ à°—à±à°°à±à°¤à°¿à°‚à°šà°¬à°¡à°¿à°‚à°¦à°¿. à°®à±à°‚à°¦à±à°•à± à°µà±†à°³à±à°³à°•à°‚à°¡à°¿. à°®à±€ UPI PIN, OTP à°²à±‡à°¦à°¾ à°µà±à°¯à°•à±à°¤à°¿à°—à°¤ à°µà°¿à°µà°°à°¾à°²à°¨à± à°Žà°µà°°à°¿à°¤à±‹à°¨à±‚ à°ªà°‚à°šà±à°•à±‹à°•à°‚à°¡à°¿.',
        actions: [
            'à°ˆ à°šà±†à°²à±à°²à°¿à°‚à°ªà± à°ªà±‚à°°à±à°¤à°¿ à°šà±‡à°¯à°•à°‚à°¡à°¿',
            'à°µà±†à°‚à°Ÿà°¨à±‡ à°®à±€ à°¬à±à°¯à°¾à°‚à°•à±à°•à± à°•à°¾à°²à± à°šà±‡à°¯à°‚à°¡à°¿',
            'à°¸à±ˆà°¬à°°à± à°•à±à°°à±ˆà°®à± à°¹à±†à°²à±à°ªà±â€Œà°²à±ˆà°¨à±â€Œà°•à± à°°à°¿à°ªà±‹à°°à±à°Ÿà± à°šà±‡à°¯à°‚à°¡à°¿: 1930',
            'cybercrime.gov.in à°²à±‹ à°«à°¿à°°à±à°¯à°¾à°¦à± à°šà±‡à°¯à°‚à°¡à°¿'
        ],
        emergency: 'à°Žà°®à°°à±à°œà±†à°¨à±à°¸à±€: 1930 (à°œà°¾à°¤à±€à°¯ à°¸à±ˆà°¬à°°à± à°•à±à°°à±ˆà°®à± à°¹à±†à°²à±à°ªà±â€Œà°²à±ˆà°¨à±) à°•à± à°•à°¾à°²à± à°šà±‡à°¯à°‚à°¡à°¿'
    },
    ta: {
        title: 'âš ï¸ à®®à¯‹à®šà®Ÿà®¿ à®Žà®šà¯à®šà®°à®¿à®•à¯à®•à¯ˆ â€” à®šà®¨à¯à®¤à¯‡à®•à®¤à¯à®¤à®¿à®±à¯à®•à¯à®°à®¿à®¯ UPI à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆ à®•à®£à¯à®Ÿà®±à®¿à®¯à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯!',
        body: 'à®‡à®¨à¯à®¤ à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆ à®®à¯‹à®šà®Ÿà®¿à®¯à®¾à®• à®‡à®°à¯à®•à¯à®•à®²à®¾à®®à¯ à®Žà®© à®•à®£à¯à®Ÿà®±à®¿à®¯à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯. à®¤à¯Šà®Ÿà®° à®µà¯‡à®£à¯à®Ÿà®¾à®®à¯. à®‰à®™à¯à®•à®³à¯ UPI PIN, OTP à®…à®²à¯à®²à®¤à¯ à®¤à®©à®¿à®ªà¯à®ªà®Ÿà¯à®Ÿ à®µà®¿à®µà®°à®™à¯à®•à®³à¯ˆ à®¯à®¾à®°à¯à®Ÿà®©à¯à®®à¯ à®ªà®•à®¿à®° à®µà¯‡à®£à¯à®Ÿà®¾à®®à¯.',
        actions: [
            'à®‡à®¨à¯à®¤ à®•à®Ÿà¯à®Ÿà®£à®¤à¯à®¤à¯ˆ à®®à¯à®Ÿà®¿à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà®¾à®®à¯',
            'à®‰à®Ÿà®©à®Ÿà®¿à®¯à®¾à®• à®‰à®™à¯à®•à®³à¯ à®µà®™à¯à®•à®¿à®¯à¯ˆ à®…à®´à¯ˆà®•à¯à®•à®µà¯à®®à¯',
            'à®šà¯ˆà®ªà®°à¯ à®•à®¿à®°à¯ˆà®®à¯ à®¹à¯†à®²à¯à®ªà¯à®²à¯ˆà®©à®¿à®²à¯ à®ªà¯à®•à®¾à®°à®³à®¿à®¯à¯à®™à¯à®•à®³à¯: 1930',
            'cybercrime.gov.in à®‡à®²à¯ à®ªà¯à®•à®¾à®°à¯ à®šà¯†à®¯à¯à®¯à¯à®™à¯à®•à®³à¯'
        ],
        emergency: 'à®…à®µà®šà®°à®¨à®¿à®²à¯ˆ: 1930 (à®¤à¯‡à®šà®¿à®¯ à®šà¯ˆà®ªà®°à¯ à®•à®¿à®°à¯ˆà®®à¯ à®¹à¯†à®²à¯à®ªà¯à®²à¯ˆà®©à¯) à®…à®´à¯ˆà®•à¯à®•à®µà¯à®®à¯'
    },
    kn: {
        title: 'âš ï¸ à²µà²‚à²šà²¨à³† à²Žà²šà³à²šà²°à²¿à²•à³† â€” à²…à²¨à³à²®à²¾à²¨à²¾à²¸à³à²ªà²¦ UPI à²µà²¹à²¿à²µà²¾à²Ÿà³ à²ªà²¤à³à²¤à³†à²¯à²¾à²—à²¿à²¦à³†!',
        body: 'à²ˆ à²µà²¹à²¿à²µà²¾à²Ÿà³ à²µà²‚à²šà²¨à³†à²¯à²¾à²—à²¿à²°à²¬à²¹à³à²¦à³ à²Žà²‚à²¦à³ à²—à³à²°à³à²¤à²¿à²¸à²²à²¾à²—à²¿à²¦à³†. à²®à³à²‚à²¦à³à²µà²°à²¿à²¯à²¬à³‡à²¡à²¿. à²¨à²¿à²®à³à²® UPI PIN, OTP à²…à²¥à²µà²¾ à²µà³ˆà²¯à²•à³à²¤à²¿à²• à²µà²¿à²µà²°à²—à²³à²¨à³à²¨à³ à²¯à²¾à²°à³Šà²‚à²¦à²¿à²—à³‚ à²¹à²‚à²šà²¿à²•à³Šà²³à³à²³à²¬à³‡à²¡à²¿.',
        actions: [
            'à²ˆ à²ªà²¾à²µà²¤à²¿ à²ªà³‚à²°à³à²£à²—à³Šà²³à²¿à²¸à²¬à³‡à²¡à²¿',
            'à²¤à²•à³à²·à²£ à²¨à²¿à²®à³à²® à²¬à³à²¯à²¾à²‚à²•à³â€Œà²—à³† à²•à²°à³† à²®à²¾à²¡à²¿',
            'à²¸à³ˆà²¬à²°à³ à²•à³à²°à³ˆà²®à³ à²¹à³†à²²à³à²ªà³â€Œà²²à³ˆà²¨à³â€Œà²—à³† à²µà²°à²¦à²¿ à²®à²¾à²¡à²¿: 1930',
            'cybercrime.gov.in à²¨à²²à³à²²à²¿ à²¦à³‚à²°à³ à²¨à³€à²¡à²¿'
        ],
        emergency: 'à²¤à³à²°à³à²¤à³: 1930 (à²°à²¾à²·à³à²Ÿà³à²°à³€à²¯ à²¸à³ˆà²¬à²°à³ à²…à²ªà²°à²¾à²§ à²¹à³†à²²à³à²ªà³â€Œà²²à³ˆà²¨à³) à²—à³† à²•à²°à³† à²®à²¾à²¡à²¿'
    },
    bn: {
        title: 'âš ï¸ à¦ªà§à¦°à¦¤à¦¾à¦°à¦£à¦¾ à¦¸à¦¤à¦°à§à¦•à¦¤à¦¾ â€” à¦¸à¦¨à§à¦¦à§‡à¦¹à¦œà¦¨à¦• UPI à¦²à§‡à¦¨à¦¦à§‡à¦¨ à¦¶à¦¨à¦¾à¦•à§à¦¤ à¦¹à¦¯à¦¼à§‡à¦›à§‡!',
        body: 'à¦à¦‡ à¦²à§‡à¦¨à¦¦à§‡à¦¨ à¦¸à¦®à§à¦­à¦¾à¦¬à§à¦¯ à¦ªà§à¦°à¦¤à¦¾à¦°à¦£à¦¾à¦®à§‚à¦²à¦• à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦šà¦¿à¦¹à§à¦¨à¦¿à¦¤ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦à¦—à¦¿à¦¯à¦¼à§‡ à¦¯à¦¾à¦¬à§‡à¦¨ à¦¨à¦¾à¥¤ à¦†à¦ªà¦¨à¦¾à¦° UPI PIN, OTP à¦¬à¦¾ à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦—à¦¤ à¦¤à¦¥à§à¦¯ à¦•à¦¾à¦°à§‹ à¦¸à¦¾à¦¥à§‡ à¦¶à§‡à¦¯à¦¼à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨ à¦¨à¦¾à¥¤',
        actions: [
            'à¦à¦‡ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦•à¦°à¦¬à§‡à¦¨ à¦¨à¦¾',
            'à¦…à¦¬à¦¿à¦²à¦®à§à¦¬à§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦¬à§à¦¯à¦¾à¦‚à¦•à§‡ à¦•à¦² à¦•à¦°à§à¦¨',
            'à¦¸à¦¾à¦‡à¦¬à¦¾à¦° à¦•à§à¦°à¦¾à¦‡à¦® à¦¹à§‡à¦²à§à¦ªà¦²à¦¾à¦‡à¦¨à§‡ à¦°à¦¿à¦ªà§‹à¦°à§à¦Ÿ à¦•à¦°à§à¦¨: 1930',
            'cybercrime.gov.in à¦ à¦…à¦­à¦¿à¦¯à§‹à¦— à¦¦à¦¾à¦¯à¦¼à§‡à¦° à¦•à¦°à§à¦¨'
        ],
        emergency: 'à¦œà¦°à§à¦°à¦¿: 1930 (à¦œà¦¾à¦¤à§€à¦¯à¦¼ à¦¸à¦¾à¦‡à¦¬à¦¾à¦° à¦…à¦ªà¦°à¦¾à¦§ à¦¹à§‡à¦²à§à¦ªà¦²à¦¾à¦‡à¦¨) à¦•à¦² à¦•à¦°à§à¦¨'
    },
    mr: {
        title: 'âš ï¸ à¤«à¤¸à¤µà¤£à¥‚à¤• à¤šà¥‡à¤¤à¤¾à¤µà¤£à¥€ â€” à¤¸à¤‚à¤¶à¤¯à¤¾à¤¸à¥à¤ªà¤¦ UPI à¤µà¥à¤¯à¤µà¤¹à¤¾à¤° à¤†à¤¢à¤³à¤²à¤¾!',
        body: 'à¤¹à¤¾ à¤µà¥à¤¯à¤µà¤¹à¤¾à¤° à¤¸à¤‚à¤­à¤¾à¤µà¥à¤¯ à¤«à¤¸à¤µà¤£à¥‚à¤• à¤®à¥à¤¹à¤£à¥‚à¤¨ à¤šà¤¿à¤¨à¥à¤¹à¤¾à¤‚à¤•à¤¿à¤¤ à¤•à¥‡à¤²à¤¾ à¤—à¥‡à¤²à¤¾ à¤†à¤¹à¥‡. à¤ªà¥à¤¢à¥‡ à¤œà¤¾à¤Š à¤¨à¤•à¤¾. à¤¤à¥à¤®à¤šà¤¾ UPI PIN, OTP à¤•à¤¿à¤‚à¤µà¤¾ à¤µà¥ˆà¤¯à¤•à¥à¤¤à¤¿à¤• à¤®à¤¾à¤¹à¤¿à¤¤à¥€ à¤•à¥‹à¤£à¤¾à¤¶à¥€à¤¹à¥€ à¤¶à¥‡à¤…à¤° à¤•à¤°à¥‚ à¤¨à¤•à¤¾.',
        actions: [
            'à¤¹à¥‡ à¤ªà¥‡à¤®à¥‡à¤‚à¤Ÿ à¤ªà¥‚à¤°à¥à¤£ à¤•à¤°à¥‚ à¤¨à¤•à¤¾',
            'à¤²à¤—à¥‡à¤š à¤¤à¥à¤®à¤šà¥à¤¯à¤¾ à¤¬à¤à¤•à¥‡à¤²à¤¾ à¤•à¥‰à¤² à¤•à¤°à¤¾',
            'à¤¸à¤¾à¤¯à¤¬à¤° à¤•à¥à¤°à¤¾à¤ˆà¤® à¤¹à¥‡à¤²à¥à¤ªà¤²à¤¾à¤‡à¤¨à¤µà¤° à¤¤à¤•à¥à¤°à¤¾à¤° à¤•à¤°à¤¾: 1930',
            'cybercrime.gov.in à¤µà¤° à¤¤à¤•à¥à¤°à¤¾à¤° à¤¦à¤¾à¤–à¤² à¤•à¤°à¤¾'
        ],
        emergency: 'à¤†à¤£à¥€à¤¬à¤¾à¤£à¥€: 1930 (à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤¸à¤¾à¤¯à¤¬à¤° à¤…à¤ªà¤°à¤¾à¤§ à¤¹à¥‡à¤²à¥à¤ªà¤²à¤¾à¤‡à¤¨) à¤µà¤° à¤•à¥‰à¤² à¤•à¤°à¤¾'
    },
    gu: {
        title: 'âš ï¸ àª›à«‡àª¤àª°àªªàª¿àª‚àª¡à«€ àªšà«‡àª¤àªµàª£à«€ â€” àª¶àª‚àª•àª¾àª¸à«àªªàª¦ UPI àªµà«àª¯àªµàª¹àª¾àª° àª¶à«‹àª§àª¾àª¯à«‹!',
        body: 'àª† àªµà«àª¯àªµàª¹àª¾àª° àª¸àª‚àª­àªµàª¿àª¤ àª›à«‡àª¤àª°àªªàª¿àª‚àª¡à«€ àª¤àª°à«€àª•à«‡ àªšàª¿àª¹à«àª¨àª¿àª¤ àª•àª°àªµàª¾àª®àª¾àª‚ àª†àªµà«àª¯à«‹ àª›à«‡. àª†àª—àª³ àª¨ àªµàª§à«‹. àª¤àª®àª¾àª°à«‹ UPI PIN, OTP àª…àª¥àªµàª¾ àªµà«àª¯àª•à«àª¤àª¿àª—àª¤ àªµàª¿àª—àª¤à«‹ àª•à«‹àªˆàª¨à«€ àª¸àª¾àª¥à«‡ àª¶à«‡àª° àª¨ àª•àª°à«‹.',
        actions: [
            'àª† àªªà«‡àª®à«‡àª¨à«àªŸ àªªà«‚àª°à«àª£ àª¨ àª•àª°à«‹',
            'àª¤àª°àª¤ àªœ àª¤àª®àª¾àª°à«€ àª¬à«‡àª‚àª•àª¨à«‡ àª•à«‰àª² àª•àª°à«‹',
            'àª¸àª¾àª¯àª¬àª° àª•à«àª°àª¾àªˆàª® àª¹à«‡àª²à«àªªàª²àª¾àªˆàª¨àª®àª¾àª‚ àª«àª°àª¿àª¯àª¾àª¦ àª•àª°à«‹: 1930',
            'cybercrime.gov.in àªªàª° àª«àª°àª¿àª¯àª¾àª¦ àª¨à«‹àª‚àª§àª¾àªµà«‹'
        ],
        emergency: 'àª•àªŸà«‹àª•àªŸà«€: 1930 (àª°àª¾àª·à«àªŸà«àª°à«€àª¯ àª¸àª¾àª¯àª¬àª° àª…àªªàª°àª¾àª§ àª¹à«‡àª²à«àªªàª²àª¾àª‡àª¨) àªªàª° àª•à«‰àª² àª•àª°à«‹'
    },
    ml: {
        title: 'âš ï¸ à´¤à´Ÿàµà´Ÿà´¿à´ªàµà´ªàµ à´®àµà´¨àµà´¨à´±à´¿à´¯à´¿à´ªàµà´ªàµ â€” à´¸à´‚à´¶à´¯à´¾à´¸àµà´ªà´¦ UPI à´‡à´Ÿà´ªà´¾à´Ÿàµ à´•à´£àµà´Ÿàµ†à´¤àµà´¤à´¿!',
        body: 'à´ˆ à´‡à´Ÿà´ªà´¾à´Ÿàµ à´¤à´Ÿàµà´Ÿà´¿à´ªàµà´ªà´¾à´¯àµ‡à´•àµà´•à´¾à´®àµ†à´¨àµà´¨àµ à´¤à´¿à´°à´¿à´šàµà´šà´±à´¿à´žàµà´žàµ. à´®àµà´¨àµà´¨àµ‹à´Ÿàµà´Ÿàµ à´ªàµ‹à´•à´°àµà´¤àµ. à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† UPI PIN, OTP à´…à´²àµà´²àµ†à´™àµà´•à´¿àµ½ à´µàµà´¯à´•àµà´¤à´¿à´—à´¤ à´µà´¿à´µà´°à´™àµà´™àµ¾ à´†à´°àµà´®à´¾à´¯àµà´‚ à´ªà´™àµà´•à´¿à´Ÿà´°àµà´¤àµ.',
        actions: [
            'à´ˆ à´ªàµ‡à´¯àµâ€Œà´®àµ†à´¨àµà´±àµ à´ªàµ‚àµ¼à´¤àµà´¤à´¿à´¯à´¾à´•àµà´•à´°àµà´¤àµ',
            'à´‰à´Ÿàµ» à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´¬à´¾à´™àµà´•à´¿à´²àµ‡à´•àµà´•àµ à´µà´¿à´³à´¿à´•àµà´•àµà´•',
            'à´¸àµˆà´¬àµ¼ à´•àµà´°àµˆà´‚ à´¹àµ†àµ½à´ªàµà´ªàµâ€Œà´²àµˆà´¨à´¿àµ½ à´±à´¿à´ªàµà´ªàµ‹àµ¼à´Ÿàµà´Ÿàµ à´šàµ†à´¯àµà´¯àµà´•: 1930',
            'cybercrime.gov.in-àµ½ à´ªà´°à´¾à´¤à´¿ à´°à´œà´¿à´¸àµà´±àµà´±àµ¼ à´šàµ†à´¯àµà´¯àµà´•'
        ],
        emergency: 'à´…à´Ÿà´¿à´¯à´¨àµà´¤à´¿à´°à´‚: 1930 (à´¦àµ‡à´¶àµ€à´¯ à´¸àµˆà´¬àµ¼ à´•àµà´±àµà´±à´•àµƒà´¤àµà´¯ à´¹àµ†àµ½à´ªàµà´ªàµà´²àµˆàµ») à´µà´¿à´³à´¿à´•àµà´•àµà´•'
    }
};

/**
 * Generate a fraud alert in a regional language using Gemini AI
 */
export async function generateAlert(fraudResult, languageCode = 'en') {
    const lang = SUPPORTED_LANGUAGES[languageCode];
    if (!lang) {
        return { error: `Unsupported language: ${languageCode}` };
    }

    // Try AI-powered alert first
    initializeAI();
    if (gemini && languageCode !== 'en') {
        try {
            const prompt = `You are a fraud prevention alert system for Indian UPI payments. Generate a fraud alert message in ${lang.name} (${lang.nativeName}).

Fraud Analysis Result:
- Risk Score: ${fraudResult.riskScore}/100
- Risk Level: ${fraudResult.riskLevel}
- Fraud Category: ${fraudResult.fraudCategory?.name || 'General Suspicious Activity'}
- Indicators: ${fraudResult.indicators?.map(i => i.label).join(', ') || 'Multiple risk factors detected'}
- Reasoning: ${fraudResult.reasoning || 'Suspicious transaction patterns detected'}

Generate the alert ENTIRELY in ${lang.name} script. Be culturally appropriate for Indian users. Include emergency helpline info.

Respond ONLY with valid JSON:
{
  "title": "alert title in ${lang.name}",
  "body": "detailed alert message in ${lang.name} explaining the danger",
  "actions": ["action 1 in ${lang.name}", "action 2", "action 3", "action 4"],
  "emergency": "emergency contact info in ${lang.name} including 1930 helpline"
}`;

            const response = await gemini.chat.completions.create({
                model: config.geminiModel,
                messages: [
                    { role: 'system', content: `You are a multilingual fraud alert generator. Respond ONLY in ${lang.name} with valid JSON.` },
                    { role: 'user', content: prompt }
                ],
                max_tokens: 800,
                temperature: 0.2
            });

            let text = response.choices[0]?.message?.content || '';
            text = text.replace(/```json/g, '').replace(/```/g, '').trim();

            const jsonMatch = text.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                const parsed = JSON.parse(jsonMatch[0]);
                return {
                    language: lang,
                    languageCode,
                    ...parsed,
                    fraudCategory: fraudResult.fraudCategory,
                    riskScore: fraudResult.riskScore,
                    riskLevel: fraudResult.riskLevel,
                    source: 'ai'
                };
            }
        } catch (error) {
            console.error(`AI alert generation error for ${lang.name}:`, error.message);
        }
    }

    // Fallback to static alerts
    const staticAlert = STATIC_ALERTS[languageCode] || STATIC_ALERTS.en;
    return {
        language: lang,
        languageCode,
        ...staticAlert,
        fraudCategory: fraudResult.fraudCategory,
        riskScore: fraudResult.riskScore,
        riskLevel: fraudResult.riskLevel,
        source: 'static'
    };
}

/**
 * Get all supported languages
 */
export function getSupportedLanguages() {
    return Object.entries(SUPPORTED_LANGUAGES).map(([code, lang]) => ({
        code,
        ...lang
    }));
}

export default { generateAlert, getSupportedLanguages, SUPPORTED_LANGUAGES };
